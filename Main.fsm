
from cozmo_fsm import *
import math
import os
import openai

openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Model.list()

intro = " "

class Start(StateNode):
    def start(self, event=None):
        self.parent.premise = "This here is what cozmo knows: \n" #Import something here
        super().start(event)

class Main(StateMachineProgram):
    def __init__(self):
        super().__init__(speech = True, speech_debug = True)
    
    class form_prompt(StateNode):
        def start(self, event=None):
            super().start(event)
            self.post_completion()
    
    #neutral net 1 (face recognition)

    #neural net 2 (sentiment analysis)

    class runGpt(StateNode):
        def start(self, event=None):
            super().start(event)
            query = event.string
            premise = self.parent.premise
            print('Q', query)
            response = openai.ChatCompletion.create(
                model="gpt-3.5-turbo",
                messages = [
                    {"role": "system", "content" : premise},
                    {"role" : "user", "content": query},
                   
                temperature=0,
                max_tokens=100,
                top_p=1,
                frequency_penalty=0.0,
                temperature=0,
                max_tokens=100,
                top_p=1,
                frequency_penalty=0.0,
                presence_penalty=0.0,
                stop=["\n"]
            )
            print(response['choices'][0]['message']['content'])
            self.post_completion()
    
    $setup {

    }